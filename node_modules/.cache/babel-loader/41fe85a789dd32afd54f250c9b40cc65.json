{"remainingRequest":"/Users/vporokhov/Desktop/SwiftyCloud/swifty.demo/node_modules/babel-loader/lib/index.js!/Users/vporokhov/Desktop/SwiftyCloud/swifty.demo/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/vporokhov/Desktop/SwiftyCloud/swifty.demo/src/components/ProfileForm.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/vporokhov/Desktop/SwiftyCloud/swifty.demo/src/components/ProfileForm.vue","mtime":1531054972814},{"path":"/Users/vporokhov/Desktop/SwiftyCloud/swifty.demo/node_modules/cache-loader/dist/cjs.js","mtime":0},{"path":"/Users/vporokhov/Desktop/SwiftyCloud/swifty.demo/node_modules/babel-loader/lib/index.js","mtime":1529635966000},{"path":"/Users/vporokhov/Desktop/SwiftyCloud/swifty.demo/node_modules/vue-loader/lib/index.js","mtime":1527860006000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.replace\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nexport default {\n  data: function data() {\n    return {\n      form: {\n        email: null,\n        city: null\n      },\n      user_image: null\n    };\n  },\n  created: function created() {\n    this.fetchProfile();\n    this.fetchPicture();\n  },\n  methods: {\n    fetchProfile: function fetchProfile() {\n      var _this = this;\n\n      return this.$store.dispatch('getProfile').then(function (response) {\n        _this.form.email = response.data.email;\n        _this.form.city = response.data.city;\n      });\n    },\n    fetchPicture: function fetchPicture() {\n      var _this2 = this;\n\n      return this.$store.dispatch('getPicture').then(function (response) {\n        _this2.user_image = 'data:image/jpeg;base64,' + response.data.img;\n      });\n    },\n    submitForm: function submitForm() {\n      var _this3 = this;\n\n      return this.$store.dispatch('updateProfile', {\n        email: this.form.email,\n        city: this.form.city\n      }).then(function (response) {\n        _this3.$notify.success({\n          title: 'Success',\n          message: 'Profile updated'\n        });\n      });\n    },\n    handlerPictureUpload: function handlerPictureUpload(option) {\n      var _this4 = this;\n\n      var file = option.file;\n      this.$store.dispatch('deletePicture').finally(function () {\n        var reader = new FileReader();\n        reader.readAsDataURL(file);\n\n        reader.onload = function () {\n          _this4.$store.dispatch('uploadPicture', reader.result.replace(/^data:image\\/(.+);base64,/, '')).then(function (response) {\n            _this4.user_image = reader.result;\n          });\n        };\n\n        reader.onerror = function (error) {\n          console.log('Error: ', error);\n        };\n      });\n    },\n    handlePictureSuccess: function handlePictureSuccess(res, file) {\n      this.user_image = URL.createObjectURL(file.raw);\n    },\n    beforePictureUpload: function beforePictureUpload(file) {\n      var isLt2M = file.size / 1024 / 1024 < 2;\n\n      if (!isLt2M) {\n        this.$message.error('Picture size can not exceed 2MB!');\n      }\n\n      return isLt2M;\n    }\n  }\n};",{"version":3,"sources":["ProfileForm.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuCA,eAAA;AACA,MADA,kBACA;AACA,WAAA;AACA,YAAA;AACA,eAAA,IADA;AAEA,cAAA;AAFA,OADA;AAMA,kBAAA;AANA,KAAA;AAQA,GAVA;AAYA,SAZA,qBAYA;AACA,SAAA,YAAA;AACA,SAAA,YAAA;AACA,GAfA;AAiBA,WAAA;AACA,gBADA,0BACA;AAAA;;AACA,aAAA,KAAA,MAAA,CAAA,QAAA,CAAA,YAAA,EAAA,IAAA,CAAA,oBAAA;AACA,cAAA,IAAA,CAAA,KAAA,GAAA,SAAA,IAAA,CAAA,KAAA;AACA,cAAA,IAAA,CAAA,IAAA,GAAA,SAAA,IAAA,CAAA,IAAA;AACA,OAHA,CAAA;AAIA,KANA;AAQA,gBARA,0BAQA;AAAA;;AACA,aAAA,KAAA,MAAA,CAAA,QAAA,CAAA,YAAA,EAAA,IAAA,CAAA,oBAAA;AACA,eAAA,UAAA,GAAA,4BAAA,SAAA,IAAA,CAAA,GAAA;AACA,OAFA,CAAA;AAGA,KAZA;AAcA,cAdA,wBAcA;AAAA;;AACA,aAAA,KAAA,MAAA,CAAA,QAAA,CAAA,eAAA,EAAA;AACA,eAAA,KAAA,IAAA,CAAA,KADA;AAEA,cAAA,KAAA,IAAA,CAAA;AAFA,OAAA,EAGA,IAHA,CAGA,oBAAA;AACA,eAAA,OAAA,CAAA,OAAA,CAAA;AACA,iBAAA,SADA;AAEA,mBAAA;AAFA,SAAA;AAIA,OARA,CAAA;AASA,KAxBA;AA0BA,wBA1BA,gCA0BA,MA1BA,EA0BA;AAAA;;AACA,UAAA,OAAA,OAAA,IAAA;AACA,WAAA,MAAA,CAAA,QAAA,CAAA,eAAA,EAAA,OAAA,CAAA,YAAA;AACA,YAAA,SAAA,IAAA,UAAA,EAAA;AACA,eAAA,aAAA,CAAA,IAAA;;AAEA,eAAA,MAAA,GAAA,YAAA;AACA,iBAAA,MAAA,CAAA,QAAA,CAAA,eAAA,EAAA,OAAA,MAAA,CAAA,OAAA,CAAA,2BAAA,EAAA,EAAA,CAAA,EAAA,IAAA,CAAA,oBAAA;AACA,mBAAA,UAAA,GAAA,OAAA,MAAA;AACA,WAFA;AAGA,SAJA;;AAMA,eAAA,OAAA,GAAA,UAAA,KAAA,EAAA;AACA,kBAAA,GAAA,CAAA,SAAA,EAAA,KAAA;AACA,SAFA;AAGA,OAbA;AAcA,KA1CA;AA4CA,wBA5CA,gCA4CA,GA5CA,EA4CA,IA5CA,EA4CA;AACA,WAAA,UAAA,GAAA,IAAA,eAAA,CAAA,KAAA,GAAA,CAAA;AACA,KA9CA;AAgDA,uBAhDA,+BAgDA,IAhDA,EAgDA;AACA,UAAA,SAAA,KAAA,IAAA,GAAA,IAAA,GAAA,IAAA,GAAA,CAAA;;AAEA,UAAA,CAAA,MAAA,EAAA;AACA,aAAA,QAAA,CAAA,KAAA,CAAA,kCAAA;AACA;;AAEA,aAAA,MAAA;AACA;AAxDA;AAjBA,CAAA","sourcesContent":["<template>\n  <el-form label-width=\"170px\" label-position=\"left\" ref=\"signUpForm\" @submit.native.prevent=\"submitForm\" :model=\"form\">\n    <el-form-item label=\"User email\">\n      <el-input placeholder=\"Email\" type=\"text\" v-model=\"form.email\"></el-input>\n    </el-form-item>\n    <el-form-item label=\"City\">\n      <el-input placeholder=\"City\" type=\"text\" v-model=\"form.city\"></el-input>\n    </el-form-item>\n    <el-form-item label=\"Auth URL\">\n      <el-input placeholder=\"Auth function URL\" type=\"text\" v-model=\"$store.state.auth_endpoint\" disabled></el-input>\n    </el-form-item>\n    <el-form-item label=\"Profile Function URL\">\n      <el-input placeholder=\"Profile management URL\" type=\"text\" v-model=\"$store.state.profile_endpoint\" disabled></el-input>\n    </el-form-item>\n    <el-form-item label=\"Picture Function URL\">\n      <el-input placeholder=\"Picture management URL\" type=\"text\" v-model=\"$store.state.picture_endpoint\" disabled></el-input>\n    </el-form-item>\n    <el-form-item label=\"Picture\">\n      <el-upload\n        class=\"picture-uploader\"\n        action=\"\"\n        accept=\"image/*\"\n        :http-request=\"handlerPictureUpload\"\n        :show-file-list=\"false\"\n        :on-success=\"handlePictureSuccess\"\n        :before-upload=\"beforePictureUpload\">\n        <img v-if=\"user_image\" :src=\"user_image\" class=\"picture\">\n        <i v-else class=\"el-icon-plus picture-uploader-icon\"></i>\n      </el-upload>\n    </el-form-item>\n    \n    <div class=\"sw-form-actions\">\n      <button type=\"submit\" style=\"display: none\"></button>\n      <el-button type=\"primary\" @click=\"submitForm\">Update profile</el-button>\n    </div>\n  </el-form>\n</template>\n\n<script>\nexport default {\n  data () {\n    return {\n      form: {\n        email: null,\n        city: null\n      },\n\n      user_image: null\n    }\n  },\n\n  created () {\n    this.fetchProfile()\n    this.fetchPicture()\n  },\n\n  methods: {\n    fetchProfile () {\n      return this.$store.dispatch('getProfile').then(response => {\n        this.form.email = response.data.email\n        this.form.city = response.data.city\n      })\n    },\n\n    fetchPicture () {\n      return this.$store.dispatch('getPicture').then(response => {\n        this.user_image = 'data:image/jpeg;base64,' + response.data.img\n      })\n    },\n\n    submitForm () {\n      return this.$store.dispatch('updateProfile', {\n        email: this.form.email,\n        city: this.form.city\n      }).then(response => {\n        this.$notify.success({\n          title: 'Success',\n          message: 'Profile updated'\n        })\n      })\n    },\n\n    handlerPictureUpload(option) {\n      var file = option.file\n      this.$store.dispatch('deletePicture').finally(() => {\n        var reader = new FileReader()\n        reader.readAsDataURL(file)\n\n        reader.onload = () => {\n          this.$store.dispatch('uploadPicture', reader.result.replace(/^data:image\\/(.+);base64,/, '')).then(response => {\n            this.user_image = reader.result\n          })\n        }\n\n        reader.onerror = function (error) {\n          console.log('Error: ', error);\n        }\n      })\n    },\n\n    handlePictureSuccess (res, file) {\n      this.user_image = URL.createObjectURL(file.raw);\n    },\n\n    beforePictureUpload (file) {\n      const isLt2M = file.size / 1024 / 1024 < 2;\n\n      if (!isLt2M) {\n        this.$message.error('Picture size can not exceed 2MB!');\n      }\n\n      return isLt2M;\n    }\n  }\n}\n</script>"],"sourceRoot":"src/components"}]}