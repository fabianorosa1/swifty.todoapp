{"remainingRequest":"/Users/vporokhov/Desktop/SwiftyCloud/swifty.demo/node_modules/babel-loader/lib/index.js!/Users/vporokhov/Desktop/SwiftyCloud/swifty.demo/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/vporokhov/Desktop/SwiftyCloud/swifty.demo/src/components/ProfileForm.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/vporokhov/Desktop/SwiftyCloud/swifty.demo/src/components/ProfileForm.vue","mtime":1536413589394},{"path":"/Users/vporokhov/Desktop/SwiftyCloud/swifty.demo/node_modules/cache-loader/dist/cjs.js","mtime":0},{"path":"/Users/vporokhov/Desktop/SwiftyCloud/swifty.demo/node_modules/babel-loader/lib/index.js","mtime":1526583314000},{"path":"/Users/vporokhov/Desktop/SwiftyCloud/swifty.demo/node_modules/vue-loader/lib/index.js","mtime":1527860006000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.replace\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport * as config from '@/config';\nexport default {\n  data: function data() {\n    return {\n      form: {\n        email: null,\n        city: null,\n        cookie: null,\n        facebook: null\n      },\n      user_image: null\n    };\n  },\n  created: function created() {\n    var _this = this;\n\n    this.fetchProfile();\n    this.fetchPicture();\n\n    if ('code' in this.$route.query) {\n      this.$store.dispatch('connectFacebook', {\n        code: this.$route.query.code,\n        redirect_uri: encodeURIComponent(window.location.origin + window.location.pathname)\n      }).then(function () {\n        return _this.fetchProfile();\n      }).then(function () {\n        _this.$router.push({\n          name: 'profile'\n        });\n      });\n    }\n  },\n  methods: {\n    fetchProfile: function fetchProfile() {\n      var _this2 = this;\n\n      return this.$store.dispatch('getProfile').then(function (response) {\n        _this2.form = response.data;\n      });\n    },\n    fetchPicture: function fetchPicture() {\n      var _this3 = this;\n\n      return this.$store.dispatch('getPicture').then(function (response) {\n        _this3.user_image = 'data:image/jpeg;base64,' + response.data.img;\n      });\n    },\n    submitForm: function submitForm() {\n      var _this4 = this;\n\n      return this.$store.dispatch('updateProfile', {\n        email: this.form.email,\n        city: this.form.city\n      }).then(function () {\n        _this4.$notify.success({\n          title: 'Success',\n          message: 'Profile updated'\n        });\n      });\n    },\n    handlerPictureUpload: function handlerPictureUpload(option) {\n      var _this5 = this;\n\n      var file = option.file;\n      this.$store.dispatch('deletePicture').finally(function () {\n        var reader = new FileReader();\n        reader.readAsDataURL(file);\n\n        reader.onload = function () {\n          _this5.$store.dispatch('uploadPicture', reader.result.replace(/^data:image\\/(.+);base64,/, '')).then(function () {\n            _this5.user_image = reader.result;\n          });\n        };\n      });\n    },\n    handlePictureSuccess: function handlePictureSuccess(res, file) {\n      this.user_image = URL.createObjectURL(file.raw);\n    },\n    beforePictureUpload: function beforePictureUpload(file) {\n      var isLt2M = file.size / 1024 / 1024 < 2;\n\n      if (!isLt2M) {\n        this.$message.error('Picture size can not exceed 2MB!');\n      }\n\n      return isLt2M;\n    },\n    connectFacebook: function connectFacebook() {\n      var redirect_uri = encodeURIComponent(window.location.origin + window.location.pathname);\n      var url = 'https://www.facebook.com/v3.0/dialog/oauth?client_id=' + config.FACEBOOK_CLIENT_ID + '&redirect_uri=' + redirect_uri;\n      window.location.href = url;\n    },\n    disconnectFacebook: function disconnectFacebook() {\n      var _this6 = this;\n\n      this.$store.dispatch('disconnectFacebook', this.$route.query).then(function () {\n        _this6.fetchProfile();\n      });\n    }\n  }\n};",{"version":3,"sources":["ProfileForm.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <el-row>\n    <el-col :lg=\"10\">\n      <el-form :xs=\"24\" :sm=\"18\" :md=\"14\" :lg=\"10\" label-width=\"170px\" label-position=\"left\" ref=\"signUpForm\" @submit.native.prevent=\"submitForm\" :model=\"form\">\n        <el-form-item label=\"User email\">\n          <el-input placeholder=\"Email\" type=\"text\" v-model=\"form.email\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"City\">\n          <el-input placeholder=\"City\" type=\"text\" v-model=\"form.city\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"Auth URL\">\n          <el-input placeholder=\"Auth function URL\" type=\"text\" v-model=\"$store.state.auth_endpoint\" disabled></el-input>\n        </el-form-item>\n        <el-form-item label=\"Facebook Auth URL\">\n          <el-input placeholder=\"Facebook function URL\" type=\"text\" v-model=\"$store.state.facebook_endpoint\" disabled></el-input>\n        </el-form-item>\n        <el-form-item label=\"Profile Function URL\">\n          <el-input placeholder=\"Profile management URL\" type=\"text\" v-model=\"$store.state.profile_endpoint\" disabled></el-input>\n        </el-form-item>\n        <el-form-item label=\"Picture Function URL\">\n          <el-input placeholder=\"Picture management URL\" type=\"text\" v-model=\"$store.state.picture_endpoint\" disabled></el-input>\n        </el-form-item>\n        <el-form-item label=\"Tasks Function URL\">\n          <el-input placeholder=\"Tasks management URL\" type=\"text\" v-model=\"$store.state.tasks_endpoint\" disabled></el-input>\n        </el-form-item>\n        <el-form-item label=\"Picture\">\n          <el-upload\n            class=\"picture-uploader\"\n            action=\"\"\n            accept=\"image/*\"\n            :http-request=\"handlerPictureUpload\"\n            :show-file-list=\"false\"\n            :on-success=\"handlePictureSuccess\"\n            :before-upload=\"beforePictureUpload\">\n            <img v-if=\"user_image\" :src=\"user_image\" class=\"picture\">\n            <i v-else class=\"el-icon-plus picture-uploader-icon\"></i>\n          </el-upload>\n        </el-form-item>\n\n        <!-- <el-form-item label=\"Facebook\">\n          <el-button type=\"success\" plain @click=\"connectFacebook\" v-if=\"!form.facebook\">Connect</el-button>\n          <el-button type=\"danger\" plain @click=\"disconnectFacebook\" v-if=\"form.facebook\">Disconnect</el-button>\n        </el-form-item> -->\n\n        <div class=\"sw-form-actions\">\n          <button type=\"submit\" style=\"display: none\"></button>\n          <el-button type=\"primary\" @click=\"submitForm\">Update profile</el-button>\n        </div>\n      </el-form>\n    </el-col>\n  </el-row>\n</template>\n\n<script>\nimport * as config from '@/config'\n\nexport default {\n  data () {\n    return {\n      form: {\n        email: null,\n        city: null,\n        cookie: null,\n        facebook: null,\n      },\n\n      user_image: null\n    }\n  },\n\n  created () {\n    this.fetchProfile()\n    this.fetchPicture()\n\n    if ('code' in this.$route.query) {\n      this.$store.dispatch('connectFacebook', {\n        code: this.$route.query.code,\n        redirect_uri: encodeURIComponent(window.location.origin + window.location.pathname)\n      }).then(() => {\n        return this.fetchProfile()\n      }).then(() => {\n        this.$router.push({ name: 'profile' })\n      })\n    }\n  },\n\n  methods: {\n    fetchProfile () {\n      return this.$store.dispatch('getProfile').then(response => {\n        this.form = response.data\n      })\n    },\n\n    fetchPicture () {\n      return this.$store.dispatch('getPicture').then(response => {\n        this.user_image = 'data:image/jpeg;base64,' + response.data.img\n      })\n    },\n\n    submitForm () {\n      return this.$store.dispatch('updateProfile', {\n        email: this.form.email,\n        city: this.form.city\n      }).then(() => {\n        this.$notify.success({\n          title: 'Success',\n          message: 'Profile updated'\n        })\n      })\n    },\n\n    handlerPictureUpload(option) {\n      var file = option.file\n      this.$store.dispatch('deletePicture').finally(() => {\n        var reader = new FileReader()\n        reader.readAsDataURL(file)\n\n        reader.onload = () => {\n          this.$store.dispatch('uploadPicture', reader.result.replace(/^data:image\\/(.+);base64,/, '')).then(() => {\n            this.user_image = reader.result\n          })\n        }\n      })\n    },\n\n    handlePictureSuccess (res, file) {\n      this.user_image = URL.createObjectURL(file.raw);\n    },\n\n    beforePictureUpload (file) {\n      const isLt2M = file.size / 1024 / 1024 < 2;\n\n      if (!isLt2M) {\n        this.$message.error('Picture size can not exceed 2MB!');\n      }\n\n      return isLt2M;\n    },\n\n    connectFacebook () {\n      const redirect_uri = encodeURIComponent(window.location.origin + window.location.pathname)\n      const url = 'https://www.facebook.com/v3.0/dialog/oauth?client_id=' + config.FACEBOOK_CLIENT_ID + '&redirect_uri=' + redirect_uri\n\n      window.location.href = url\n    },\n\n    disconnectFacebook () {\n      this.$store.dispatch('disconnectFacebook', this.$route.query).then(() => {\n        this.fetchProfile()\n      })\n    }\n  }\n}\n</script>\n"],"sourceRoot":"src/components"}]}